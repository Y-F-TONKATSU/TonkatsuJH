<html lang='ja'>

	<head>
		
		<!--meta--writing000007-->
		
	</head>
	
	<body>
		
		<!--header--writing000007-->
					
		<div id="cont">
			
			<div class="outer">
			
				<div class="inner">
					AE の基本機能の覚書の続きです。<br>
					前回は<a href="http://ton-katsu.net#writing000006">こちら</a>。<br>
					今回はレンダリングの順序と<br>
					微妙に関連するものとして<br>
					T マークについて。<br>
				</div>
				
			</div>
			
			<div class="outer">
			
				<div class="inner">
					<h2>とりあえず豆知識</h2>
					レイヤーパネルでは<br>
					Ctrl+A で全レイヤー選択だが、<br>
					エフェクト、シェイプ、マスク、<br>
					ペイントストロークなんかを<br>
					選択していて、なおかつ<br>
					現在レイヤーに<br>
					それらのアイテムが<br>
					複数ある場合は<br>
					その階層の全アイテムを<br>
					選択してくれる。<br>
					つまり、マスクを選択中なら<br>
					そのレイヤーのマスクを<br>
					全て選択、という具合。<br>
					大量のペイントストロークの<br>
					プロパティを全部変えたいときに<br>
					いちいち Shift クリックで<br>
					選択しなくても OK で、<br>
					整合性に欠ける気はするけど<br>
					インテリジェントな動作。<br>
					(一応書いたけど、<br>
					これに気付かないの<br>
					自分だけのような気もする。)
				</div>
				
			</div>
			
			<div class="outer">
			
				<div class="inner">
					<h2>レイヤーの<br>
					レンダリングオーダー</h2>
					レイヤーの<br>
					レンダリングの順序は<br>
					それなりに直観に近いものなので、<br>
					普段は特に意識しないけど、<br>
					何か予想外の結果になった時には<br>
					原則を知っている方が<br>
					落ち着いて対処しやすい。
				</div>
				
			</div>
			
			<div class="outer">
			
				<div class="inner">
					原則 1:<br>
					ネストされてるものは<br>
					階層の深いものが先。<br>
				</div>
				
			</div>
			
			<div class="outer">
			
				<div class="inner">
					原則 2:<br>
					レイヤーは下から上に<br>
					順番にレンダリングされる。
				</div>
				
			</div>
			
			<div class="outer">
			
				<div class="inner">
					原則 3:<br>
					各レイヤー毎のプロパティの<br>
					レンダリングオーダーは<br>
					プロパティの表示の上から順。<br>
					重要なのはこれ。<br>
					(カラコレなど、<br>
					フッテージの解釈に<br>
					含まれるものは<br>
					一番最初。)
				</div>
				
				<div class="inner">
					レイヤーのプロパティは<br>
					オーディオとか<br>
					テキストとかの<br>
					固有のやつを除くと<br>
					・マスク<br>
					・エフェクト<br>
					・トランスフォーム<br>
					・レイヤースタイル<br>
					に大別されて、<br>
					（ペイントは<br>
					エフェクトの一種と<br>
					みなされる。）<br>
					上記の順に表示される。<br>
					レンダリングの順序も<br>
					上記の通り。<br>
					(ただし、コラップストランスフォームを<br>
					オンにしたレイヤー、<br>
					シェイプやテキストや<br>
					.ai ファイルや<br>
					.swf ファイルなどの<br>
					ベクターレイヤーは例外。<br>
					これに関しては次回。)
				</div>
				
				<div class="inner">
					この固定されたオーダーのせいで、<br>
					簡単にできそうなことが<br>
					出来なくて<br>
					「あれ？」<br>
					となることがたまにある。<br>
					例えば、レイヤースタイルで<br>
					ドロップシャドウを付けて、<br>
					ディストーションエフェクトで<br>
					その影ごと歪ませるとか、<br>
					影の一部を<br>
					マスクで隠すとかは、<br>
					歪んだものに影がついたり、<br>
					隠れたものに影が付く結果になり、<br>
					通常のレンダリングオーダーでは<br>
					出来ないことが分かる。
				</div>
				
			</div>
			
			<div class="outer">
			
				<div class="inner">
					対処:<br>
					基本的には適当に<br>
					プリコンポーズ<br>
					(場合によっては<br>
					プリレンダリングしてもいい)<br>
					すれば、<br>
					若干の複雑さと引き換えに<br>
					レンダリングオーダーを<br>
					変更できるので、<br>
					これでだいたい解決する。
				</div>
				
				<div class="inner">
					<h3>トランスフォームエフェクト</h3>
					ディストーションエフェクトの中に<br>
					トランスフォームというやつがあって、<br>
					トランスフォームを<br>
					エフェクトとして<br>
					掛けることができる。<br>
					(扱えるプロパティも<br>
					若干増えている。)<br>
					これを使うと<br>
					トランスフォームした後に<br>
					別のエフェクトを<br>
					掛けることができる。
				</div>
				
				<div class="inner">
					<h3>調整レイヤー</h3>
					調整レイヤーに掛けた<br>
					エフェクトは<br>
					レンダリングオーダーが<br>
					調整レイヤーに達した段階で<br>
					レンダリングされるので、<br>
					これで解決することもある。
				</div>
				
				<div class="inner">
					注意点:<br>
					調整レイヤーの<br>
					トランスフォームプロパティは<br>
					調整レイヤー自体を<br>
					変形させる。<br>
					調整レイヤー以下の全レイヤーを<br>
					トランスフォームさせたい時は<br>
					トランスフォームエフェクトを使う。
				</div>
				
				<div class="inner">
					<h3>14/11/01 追記:トラックマット</h3>
					トラックマットはどうなんだろう？<br>
					と思ったので調べてみたが、<br>
					ドキュメントは見つからなかったので<br>
					実験してみた。<br>
					どうもトランスフォームと<br>
					レイヤースタイルの<br>
					間で処理されてるっぽい。<br>
					どうしてこういう順序になってるのか<br>
					考えてみると、<br>
					できるだけ直感的な処理になるように<br>
					いろいろ考えた跡が<br>
					見えるようなのだが、<br>
					それでも順序をいじる必要は<br>
					生じてしまうわけだ。
				</div>
				
			</div>
			
			<div class="outer">
			
				<div class="inner">
					<h2>T のマーク</h2>
					タイムラインの<br>
					レイヤーの合成モード列と<br>
					トラックマット列の間にある<br>
					"T" のマーク。<br>
					これなんだろうな、<br>
					と思ってた時期がしばらくあった。
				</div>
				
				<div class="inner">
					T のスイッチをオンにすると、<br>
					そのレイヤーは<br>
					それ以下のレイヤーの<br>
					アルファチャンネルを<br>
					保持する。<br>
					…というと分かり難いが、<br>
					オンにしたレイヤーから<br>
					アルファチャンネルを変更する権利を<br>
					奪うスイッチだと思えばいい。
				</div>
				
				<div class="inner">
					何もレイヤーがない状態の<br>
					コンポジションは<br>
					完全に透明なので、<br>
					全てのピクセルの<br>
					アルファ値(不透明度)が<br>
					0 で真っ黒な状態である。<br>
					これにレイヤーを<br>
					配置するごとに<br>
					配置されるレイヤーの<br>
					アルファ値が<br>
					下のレイヤーから順に<br>
					加算されていく、<br>
					という具合に<br>
					考えることができる。<br>
					このとき、<br>
					配置されたレイヤーの<br>
					T のスイッチがオンだと<br>
					そのレイヤーは<br>
					アルファ値を加算せずに<br>
					カラー値のみを変更する。
				</div>
				
				<div class="inner">
					例:<br>
					レイヤー2の<br>
					T スイッチがオンだとする。<br>
					AE は下のレイヤーから<br>
					順にレンダリングするので、<br>
					一番下のレイヤー1を<br>
					まずレンダリングする。<br>
					この時もし、<br>
					レイヤー1に<br>
					完全に透明なピクセルが<br>
					含まれていれば、<br>
					レイヤー2でもそのピクセルは<br>
					レイヤー2でのアルファ値にかかわらず<br>
					完全に透明になる。<br>
					レイヤー1に半透明なピクセルが<br>
					含まれていれば、<br>
					レイヤー2でもそのピクセルは<br>
					半透明になる。<br>
					もちろんレイヤー1の<br>
					アルファチャンネルが<br>
					真っ白なら何も起こらない。
				</div>
				
				<div class="inner">
					さらにざっくり言うなら<br>
					下のレイヤー全部を対象にした<br>
					アルファトラックマット<br>
					みたいなものである。<br>
					(ただし下のレイヤーは<br>
					非表示にならない)
				</div>
				
				<div class="inner">
					大抵トラックマットで間に合うので、<br>
					知らなくても<br>
					そこまで困らない機能ではある。
				</div>
				
			</div>
			
			
			<div class="outer">
			
				<div class="inner">
					もう一つ<br>
					微妙に関連する話題として、<br>
					コラップストランスフォーム/<br>
					連続ラスタライズについても<br>
					書いてたんですが、<br>
					長くなっちゃったので<br>
					<a href="http://ton-katsu.net/#writing000008">次回</a>に続きます。
				</div>
				
			</div>

		</div>
		
		<!--footer--writing000007-->
		
	</body>
	
</html>		